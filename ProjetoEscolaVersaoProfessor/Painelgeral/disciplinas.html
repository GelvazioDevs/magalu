<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Disciplinas</title>
  <link rel="stylesheet" href="usuarios.css">
  <link rel="stylesheet" href="disciplinas.css">
  <link rel="stylesheet" href="button.css">
</head>
<body>
  <div class="light-bg-anim"></div>
  <div class="luz-linha"></div>
  <div class="layout">
    <div id="sidebar"></div>
    <div class="content">
      <h2>Gestão de Disciplinas</h2>
      <div class="search-box" id="searchBoxDisciplinas">
        <select id="filtroArea">
          <option value="">Área</option>
          <option value="EXATAS">Exatas</option>
          <option value="HUMANAS">Humanas</option>
          <option value="LINGUAGENS">Linguagens</option>
          <option value="OUTRAS">Outras</option>
        </select>
        <input type="text" id="pesquisaDisciplina" placeholder="Pesquisar disciplina...">
      </div>
      <button class="pesquisar-button" onclick="carregaDadosDisciplinas()">Pesquisar</button>
      <div class="disciplinas-tabela-container" id="containerDisciplinas">
        <table id="tabelaDisciplinas" class="disciplinas-tabela">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Área</th>
              <th>Carga Horária</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <div class="disciplinas-tabela-container" id="containerNotas" style="display:none;">
        <table id="tabelaNotas" class="disciplinas-tabela">
          <thead>
            <tr>
              <th>Disciplina</th>
              <th>Série</th>
              <th>Professor</th>
              <th>Status</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>
  </div>
  <script src="../Scripts/md5.js"></script>

  <script src="../Scripts/professores.js"></script>  
  <script src="../Scripts/disciplinas.js"></script>  
  <script src="../Scripts/api.js"></script>

  <script>
    
    fetch('sidebar.html').then(res => res.text()).then(data => {
      document.getElementById('sidebar').innerHTML = data;
      const usuario = JSON.parse(localStorage.getItem('usuarioLogado')) || { nome: 'Convidado', cargo: 'Convidado', email: '' };
      document.getElementById('sidebarUsuarioNome').textContent = usuario.nome || 'Convidado';
      document.getElementById('sidebarUsuarioCargo').textContent = usuario.cargo || 'Convidado';
      const avatar = document.getElementById('sidebarUsuarioAvatar');
      if (usuario.email) {
        const hash = md5(usuario.email.trim().toLowerCase());
        avatar.src = `https://www.gravatar.com/avatar/${hash}?d=identicon&s=80`;
      } else {
        avatar.src = '../Imagens/Usuario.png';
      }
      avatar.alt = usuario.nome || 'Convidado';
    });
    
    // Exibir tabela conforme o cargo
    const usuario = JSON.parse(localStorage.getItem('usuarioLogado')) || { cargo: 'Aluno' };
    if (usuario.cargo === 'Aluno') {
      document.getElementById('containerDisciplinas').style.display = 'none';
      document.getElementById('searchBoxDisciplinas').style.display = 'none';
      document.getElementById('containerNotas').style.display = '';
    } else {
      document.getElementById('containerDisciplinas').style.display = '';
      document.getElementById('searchBoxDisciplinas').style.display = '';
      document.getElementById('containerNotas').style.display = 'none';
    }

    async function carregaDadosDisciplinas(){
      await buscarDadosApi('disciplinas');
    }

  </script>


</body>
</html>